# Render Blueprint with Root Directories (Alternative structure)
# Use this ONLY if you reorganize into separate service directories

services:
  # Main Web Application
  - type: web
    name: bloomwatch-web
    env: python
    region: oregon
    plan: free
    branch: main
    # Set root directory if app files are in a subdirectory
    # rootDirectory: ./app
    buildCommand: pip install -r requirements.txt
    startCommand: streamlit run streamlit_app_enhanced.py --server.port=$PORT --server.address=0.0.0.0 --server.headless=true
    envVars:
      - key: PYTHON_VERSION
        value: 3.11.0
      - key: MONGODB_URI
        sync: false
      - key: AFRICASTALKING_USERNAME
        sync: false
      - key: AFRICASTALKING_API_KEY
        sync: false

  # Admin Dashboard
  - type: web
    name: bloomwatch-admin
    env: python
    region: oregon
    plan: free
    branch: main
    # rootDirectory: ./app
    buildCommand: pip install -r requirements.txt
    startCommand: streamlit run admin_dashboard.py --server.port=$PORT --server.address=0.0.0.0 --server.headless=true
    envVars:
      - key: PYTHON_VERSION
        value: 3.11.0
      - key: MONGODB_URI
        sync: false
      - key: ADMIN_PASSWORD
        sync: false

  # USSD API
  - type: web
    name: bloomwatch-ussd
    env: python
    region: oregon
    plan: free
    branch: main
    # Set root directory to backend folder
    rootDirectory: ./backend
    buildCommand: pip install -r requirements.txt
    # No need for 'cd backend' since we're already there
    startCommand: gunicorn ussd_api:app --bind 0.0.0.0:$PORT --workers 2 --timeout 120
    envVars:
      - key: PYTHON_VERSION
        value: 3.11.0
      - key: MONGODB_URI
        sync: false
      - key: FLASK_ENV
        value: production
    healthCheckPath: /health


